# 服务项目管理模块 - 前后端文件映射清单

> 本清单聚焦“服务项目（services）”的增删改查、分页查询、预约时服务选择（/all）等联调入口，便于快速定位代码。

---

## 前端文件（Vue 3 + Vite）

- 服务项目管理页面： [oldcare-system-front/src/views/ServiceView.vue](oldcare-system-front/src/views/ServiceView.vue)
- 服务项目 API 封装： [oldcare-system-front/src/api/service.js](oldcare-system-front/src/api/service.js)
- 通用 HTTP 客户端（baseURL=/api、拦截器、Token 注入）： [oldcare-system-front/src/api/http.js](oldcare-system-front/src/api/http.js)
- 路由与角色守卫（含 `/services` 路由）： [oldcare-system-front/src/router/index.js](oldcare-system-front/src/router/index.js)
- 认证状态（Token/sessionStorage）： [oldcare-system-front/src/store/auth.js](oldcare-system-front/src/store/auth.js)

### 跨模块：预约页面使用服务列表

- 预约创建/编辑时服务下拉选择（调用 `fetchAllServices()`）： [oldcare-system-front/src/views/AppointmentView.vue](oldcare-system-front/src/views/AppointmentView.vue)

---

## 后端文件（Spring Boot + MyBatis-Plus）

- 控制器（接口入口）： [oldcare-system/src/main/java/com/example/oldcaresystem/controller/ServiceController.java](oldcare-system/src/main/java/com/example/oldcaresystem/controller/ServiceController.java)
- 服务层（MyBatis-Plus ServiceImpl）： [oldcare-system/src/main/java/com/example/oldcaresystem/service/ServiceManageService.java](oldcare-system/src/main/java/com/example/oldcaresystem/service/ServiceManageService.java)
- 实体（映射 `services` 表）： [oldcare-system/src/main/java/com/example/oldcaresystem/entity/Service.java](oldcare-system/src/main/java/com/example/oldcaresystem/entity/Service.java)
- Mapper： [oldcare-system/src/main/java/com/example/oldcaresystem/mapper/ServiceMapper.java](oldcare-system/src/main/java/com/example/oldcaresystem/mapper/ServiceMapper.java)

### 认证与访问控制相关（影响 /api/service 是否可访问）

- Spring Security 放行与拦截规则： [oldcare-system/src/main/java/com/example/oldcaresystem/config/SecurityConfig.java](oldcare-system/src/main/java/com/example/oldcaresystem/config/SecurityConfig.java)
- JWT 鉴权过滤器： [oldcare-system/src/main/java/com/example/oldcaresystem/security/JwtAuthenticationFilter.java](oldcare-system/src/main/java/com/example/oldcaresystem/security/JwtAuthenticationFilter.java)

---

## 接口清单（路径映射）

> 前端 `http.js` 的 `baseURL` 是 `/api`，因此 `service.js` 里写的 `service/...` 最终请求为 `/api/service/...`。

- 分页查询服务列表：`GET /api/service?current=1&size=10&serviceName=护理`
  - 前端： [oldcare-system-front/src/api/service.js](oldcare-system-front/src/api/service.js)（`fetchServices`） + [oldcare-system-front/src/views/ServiceView.vue](oldcare-system-front/src/views/ServiceView.vue)
  - 后端： [oldcare-system/src/main/java/com/example/oldcaresystem/controller/ServiceController.java](oldcare-system/src/main/java/com/example/oldcaresystem/controller/ServiceController.java)

- 查询所有可用服务（不分页，用于下拉）：`GET /api/service/all`
  - 前端： [oldcare-system-front/src/api/service.js](oldcare-system-front/src/api/service.js)（`fetchAllServices`）
  - 使用页面： [oldcare-system-front/src/views/AppointmentView.vue](oldcare-system-front/src/views/AppointmentView.vue)
  - 后端： [oldcare-system/src/main/java/com/example/oldcaresystem/controller/ServiceController.java](oldcare-system/src/main/java/com/example/oldcaresystem/controller/ServiceController.java)

- 查询单个服务：`GET /api/service/{id}`
  - 后端： [oldcare-system/src/main/java/com/example/oldcaresystem/controller/ServiceController.java](oldcare-system/src/main/java/com/example/oldcaresystem/controller/ServiceController.java)

- 新增服务：`POST /api/service`
  - 前端： [oldcare-system-front/src/api/service.js](oldcare-system-front/src/api/service.js)（`createService`） + [oldcare-system-front/src/views/ServiceView.vue](oldcare-system-front/src/views/ServiceView.vue)
  - 后端： [oldcare-system/src/main/java/com/example/oldcaresystem/controller/ServiceController.java](oldcare-system/src/main/java/com/example/oldcaresystem/controller/ServiceController.java)

- 修改服务：`PUT /api/service`
  - 前端： [oldcare-system-front/src/api/service.js](oldcare-system-front/src/api/service.js)（`updateService`） + [oldcare-system-front/src/views/ServiceView.vue](oldcare-system-front/src/views/ServiceView.vue)
  - 后端： [oldcare-system/src/main/java/com/example/oldcaresystem/controller/ServiceController.java](oldcare-system/src/main/java/com/example/oldcaresystem/controller/ServiceController.java)

- 删除服务：`DELETE /api/service/{id}`
  - 前端： [oldcare-system-front/src/api/service.js](oldcare-system-front/src/api/service.js)（`deleteService`） + [oldcare-system-front/src/views/ServiceView.vue](oldcare-system-front/src/views/ServiceView.vue)
  - 后端： [oldcare-system/src/main/java/com/example/oldcaresystem/controller/ServiceController.java](oldcare-system/src/main/java/com/example/oldcaresystem/controller/ServiceController.java)

---

## 数据库表

- SQL 脚本（包含 `services` 表结构）： [oldcare-system/src/main/resources/db/oldcare_system.sql](oldcare-system/src/main/resources/db/oldcare_system.sql)

---

## 备注（联调时容易踩坑的点）

- 后端 `GET /api/service` 和 `GET /api/service/all` 目前固定过滤 `status=1`（仅返回可用服务），因此“禁用(0)”的服务不会出现在列表里。
- 后端目前未对新增/修改/删除接口做管理员角色校验（仅由前端页面是否展示按钮来控制），如需严格权限需在后端增加基于 `UserContext` 或 Spring Security 的角色校验。