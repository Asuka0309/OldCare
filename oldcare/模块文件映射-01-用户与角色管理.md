# 用户与角色管理模块 - 前后端文件映射清单

> 本清单聚焦“登录 / 注册 / 用户管理（CRUD）/ 权限控制（JWT）”相关的前后端代码位置与接口路径，便于联调与排查。

---

## 前端文件（Vue 3 + Vite）

- 登录页面： [oldcare-system-front/src/views/LoginView.vue](oldcare-system-front/src/views/LoginView.vue)
- 注册页面： [oldcare-system-front/src/views/RegisterView.vue](oldcare-system-front/src/views/RegisterView.vue)
- 用户管理页： [oldcare-system-front/src/views/UserView.vue](oldcare-system-front/src/views/UserView.vue)
- 路由与守卫： [oldcare-system-front/src/router/index.js](oldcare-system-front/src/router/index.js)
- 认证状态（Pinia）： [oldcare-system-front/src/store/auth.js](oldcare-system-front/src/store/auth.js)
- 通用HTTP客户端（基址/拦截器/Token注入）： [oldcare-system-front/src/api/http.js](oldcare-system-front/src/api/http.js)
- 认证相关API（登录/注册）： [oldcare-system-front/src/api/auth.js](oldcare-system-front/src/api/auth.js)
- 用户管理API（列表/新增/更新/删除/状态）： [oldcare-system-front/src/api/user.js](oldcare-system-front/src/api/user.js)

---

## 后端文件（Spring Boot + MyBatis-Plus + Spring Security + JWT）

- 控制器
  - 认证与登录： [oldcare-system/src/main/java/com/example/oldcaresystem/controller/AuthController.java](oldcare-system/src/main/java/com/example/oldcaresystem/controller/AuthController.java)
  - 用户管理： [oldcare-system/src/main/java/com/example/oldcaresystem/controller/UserController.java](oldcare-system/src/main/java/com/example/oldcaresystem/controller/UserController.java)
- 服务与业务
  - 用户业务： [oldcare-system/src/main/java/com/example/oldcaresystem/service/UserService.java](oldcare-system/src/main/java/com/example/oldcaresystem/service/UserService.java)
- DTO
  - 登录请求： [oldcare-system/src/main/java/com/example/oldcaresystem/dto/LoginRequest.java](oldcare-system/src/main/java/com/example/oldcaresystem/dto/LoginRequest.java)
  - 登录响应： [oldcare-system/src/main/java/com/example/oldcaresystem/dto/LoginResponse.java](oldcare-system/src/main/java/com/example/oldcaresystem/dto/LoginResponse.java)
- 实体与数据访问
  - 用户实体： [oldcare-system/src/main/java/com/example/oldcaresystem/entity/User.java](oldcare-system/src/main/java/com/example/oldcaresystem/entity/User.java)
  - 用户Mapper： [oldcare-system/src/main/java/com/example/oldcaresystem/mapper/UserMapper.java](oldcare-system/src/main/java/com/example/oldcaresystem/mapper/UserMapper.java)
- 安全与认证
  - 安全配置： [oldcare-system/src/main/java/com/example/oldcaresystem/config/SecurityConfig.java](oldcare-system/src/main/java/com/example/oldcaresystem/config/SecurityConfig.java)
  - JWT过滤器： [oldcare-system/src/main/java/com/example/oldcaresystem/security/JwtAuthenticationFilter.java](oldcare-system/src/main/java/com/example/oldcaresystem/security/JwtAuthenticationFilter.java)
  - 未认证处理： [oldcare-system/src/main/java/com/example/oldcaresystem/security/JwtAuthenticationEntryPoint.java](oldcare-system/src/main/java/com/example/oldcaresystem/security/JwtAuthenticationEntryPoint.java)
  - 用户上下文： [oldcare-system/src/main/java/com/example/oldcaresystem/security/UserContext.java](oldcare-system/src/main/java/com/example/oldcaresystem/security/UserContext.java)
  - JWT用户详情： [oldcare-system/src/main/java/com/example/oldcaresystem/security/JwtUserDetails.java](oldcare-system/src/main/java/com/example/oldcaresystem/security/JwtUserDetails.java)
- 工具类
  - JWT工具： [oldcare-system/src/main/java/com/example/oldcaresystem/util/JwtUtil.java](oldcare-system/src/main/java/com/example/oldcaresystem/util/JwtUtil.java)
  - MD5工具： [oldcare-system/src/main/java/com/example/oldcaresystem/util/MD5Util.java](oldcare-system/src/main/java/com/example/oldcaresystem/util/MD5Util.java)
  - 统一响应： [oldcare-system/src/main/java/com/example/oldcaresystem/util/ResponseUtil.java](oldcare-system/src/main/java/com/example/oldcaresystem/util/ResponseUtil.java) / [oldcare-system/src/main/java/com/example/oldcaresystem/util/ApiResponse.java](oldcare-system/src/main/java/com/example/oldcaresystem/util/ApiResponse.java)
- 配置与脚本
  - 应用配置： [oldcare-system/src/main/resources/application.properties](oldcare-system/src/main/resources/application.properties)
  - 数据脚本： [oldcare-system/src/main/resources/db/oldcare_system.sql](oldcare-system/src/main/resources/db/oldcare_system.sql)

---

## 接口清单（路径映射）

- 认证
  - 登录： `POST /api/auth/login`
    - 前端： [oldcare-system-front/src/api/auth.js](oldcare-system-front/src/api/auth.js)
    - 后端： [oldcare-system/src/main/java/com/example/oldcaresystem/controller/AuthController.java](oldcare-system/src/main/java/com/example/oldcaresystem/controller/AuthController.java)
  - 注册（通用）： `POST /api/auth/register`
    - 前端（RegisterView 默认走 /user/register，如需切换可在此处更改）： [oldcare-system-front/src/api/auth.js](oldcare-system-front/src/api/auth.js)
    - 后端： [oldcare-system/src/main/java/com/example/oldcaresystem/controller/AuthController.java](oldcare-system/src/main/java/com/example/oldcaresystem/controller/AuthController.java)
  - 注册（用户模块）： `POST /api/user/register`
    - 前端（当前使用的注册接口）： [oldcare-system-front/src/api/auth.js](oldcare-system-front/src/api/auth.js) / [oldcare-system-front/src/views/RegisterView.vue](oldcare-system-front/src/views/RegisterView.vue)
    - 后端： [oldcare-system/src/main/java/com/example/oldcaresystem/controller/UserController.java](oldcare-system/src/main/java/com/example/oldcaresystem/controller/UserController.java)

- 用户管理（需认证，管理员权限）
  - 分页查询： `GET /api/user`
    - 前端： [oldcare-system-front/src/api/user.js](oldcare-system-front/src/api/user.js) / [oldcare-system-front/src/views/UserView.vue](oldcare-system-front/src/views/UserView.vue)
    - 后端： [oldcare-system/src/main/java/com/example/oldcaresystem/controller/UserController.java](oldcare-system/src/main/java/com/example/oldcaresystem/controller/UserController.java)
  - 详情： `GET /api/user/{id}`
  - 新增： `POST /api/user`
  - 更新： `PUT /api/user`
  - 更新状态： `PUT /api/user/{id}/status?status=0|1`
  - 删除： `DELETE /api/user/{id}`

---

## 关键流程与钩子位置

- 前端Token注入（Authorization: Bearer ...）： [oldcare-system-front/src/api/http.js](oldcare-system-front/src/api/http.js)
- 前端登录状态存储（sessionStorage，多标签页互不影响）： [oldcare-system-front/src/store/auth.js](oldcare-system-front/src/store/auth.js)
- 前端路由守卫（未登录重定向、角色校验）： [oldcare-system-front/src/router/index.js](oldcare-system-front/src/router/index.js)
- 后端JWT解析与鉴权： [oldcare-system/src/main/java/com/example/oldcaresystem/security/JwtAuthenticationFilter.java](oldcare-system/src/main/java/com/example/oldcaresystem/security/JwtAuthenticationFilter.java)
- 后端安全配置与白名单： [oldcare-system/src/main/java/com/example/oldcaresystem/config/SecurityConfig.java](oldcare-system/src/main/java/com/example/oldcaresystem/config/SecurityConfig.java)

---

## 数据库表

- 用户表定义与索引： [oldcare-system/src/main/resources/db/oldcare_system.sql](oldcare-system/src/main/resources/db/oldcare_system.sql)

---

## 备注

- 密码加密当前采用MD5（见 [MD5Util.java](oldcare-system/src/main/java/com/example/oldcaresystem/util/MD5Util.java)），建议后续升级为BCrypt。
- 角色取值在部分前端页面与后端默认值存在差异（如 `elderly_family` / `resident`），联调时注意统一。