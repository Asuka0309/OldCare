# 养老服务管理系统 - 项目总结

## 📋 项目概述

**项目名称**：养老服务管理系统 (OldCare System)  
**开发时间**：2025年12月  
**项目类型**：前后端分离的 Web 应用系统  
**业务领域**：养老服务、社区照护、预约管理

### 核心价值
- 为养老机构提供数字化管理平台
- 实现居民、护工、管理员的协同工作
- 涵盖预约、费用、健康、评价等全流程管理

---

## 🛠️ 技术栈

### 后端技术
- **框架**：Spring Boot 2.7+
- **数据库**：MySQL 8.0
- **ORM**：MyBatis-Plus
- **安全**：Spring Security + JWT
- **API 文档**：Swagger/Knife4j
- **构建工具**：Maven

### 前端技术
- **框架**：Vue 3 (Composition API)
- **UI 组件库**：Element Plus
- **状态管理**：Pinia
- **路由**：Vue Router 4
- **HTTP 客户端**：Axios
- **图表**：ECharts
- **构建工具**：Vite

### 开发工具
- **IDE**：VS Code / IntelliJ IDEA
- **版本控制**：Git
- **数据库管理**：MySQL Workbench / DataGrip

---

## 👥 角色与权限

### 系统角色
| 角色 | 英文标识 | 主要职责 |
|------|---------|---------|
| 系统管理员 | admin | 全局管理、审批、数据维护 |
| 护工/员工 | caregiver | 服务执行、预约处理 |
| 居民 | resident | 预约服务、申请退款 |

### 权限矩阵
| 功能模块 | 管理员 | 护工 | 居民 |
|---------|-------|------|------|
| **用户管理** | 增删改查 | 仅查看 | - |
| **居民档案** | 增删改查 | 查看 | 查看自己 |
| **护工管理** | 增删改查 | 查看 | - |
| **服务管理** | 增删改查 | 查看 | 查看 |
| **预约管理** | 增删改查 | 确认/完成/查看 | 创建/查看自己 |
| **费用管理** | 审批支付/审批退款 | 仅查看 | 申请退款 |
| **健康档案** | 查看所有 | 查看/记录 | 查看自己 |
| **服务评价** | 查看所有 | 查看自己 | 创建/查看自己 |
| **收益统计** | 查看所有 | 查看自己 | - |
| **社区活动** | 增删改查 | 查看 | 查看 |
| **新闻公告** | 增删改查 | 查看 | 查看 |

---

## 📦 功能模块

### 1. 用户认证与授权
- ✅ 用户注册（居民/护工两种角色）
- ✅ 用户登录（JWT Token 认证）
- ✅ 角色权限控制
- ✅ 多标签页独立登录（sessionStorage）

### 2. 居民管理
- ✅ 居民档案维护（姓名、年龄、健康状况、紧急联系人）
- ✅ 关联用户账号（user_id）
- ✅ 居民筛选与分页查询

### 3. 护工管理
- ✅ 护工信息管理（员工档案）
- ✅ 服务评分展示（5星评分）
- ✅ 护工筛选与查询

### 4. 服务管理
- ✅ 服务类型定义（陪护、医疗、生活照料等）
- ✅ 服务定价管理
- ✅ 服务状态管理

### 5. 预约管理 ⭐核心模块
- ✅ 创建预约（选择老人、护工、服务、时间）
- ✅ 预约状态流转：待确认 → 已确认 → 已完成
- ✅ 预约取消
- ✅ 完成预约自动生成费用记录
- ✅ 按老人/状态筛选

### 6. 费用管理 ⭐核心模块
- ✅ 费用记录自动生成（完成预约时）
- ✅ 手动创建费用记录（管理员）
- ✅ 标记支付（管理员）
- ✅ 申请退款（居民）
- ✅ 审批退款（管理员：同意/拒绝）
- ✅ 费用状态流转：未支付 → 已支付 → 退款申请中 → 已退款/已支付

### 7. 健康管理
- ✅ 健康档案记录（血压、心率、血糖等）
- ✅ 健康检查计划
- ✅ 历史记录查询

### 8. 服务评价
- ✅ 预约完成后评价（评分+评论）
- ✅ 护工评分统计
- ✅ 评价历史查看

### 9. 收益统计
- ✅ 护工收益统计（按月统计）
- ✅ 收益趋势图表（ECharts）
- ✅ 收益数据导出

### 10. 社区活动
- ✅ 活动发布与管理
- ✅ 活动报名
- ✅ 活动时间地点管理

### 11. 新闻公告
- ✅ 新闻发布
- ✅ 公告展示
- ✅ 新闻分类

### 12. 系统通知
- ✅ 系统消息通知
- ✅ 通知已读/未读状态

### 13. 紧急求助
- ✅ 紧急求助记录
- ✅ 求助处理流程

### 14. 数据看板
- ✅ 统计数据展示
- ✅ 天气信息集成
- ✅ 快速操作入口

---

## 🔄 核心业务流程

### 预约-费用完整流程

```
【正常流程】
1. 居民/管理员 → 新建预约
   ↓
2. 系统自动设置 → 状态：待确认（费用自动计算）
   ↓
3. 管理员/护工 → 确认预约 → 状态：已确认
   ↓
4. 管理员/护工 → 完成预约 → 状态：已完成
   ↓ (自动触发)
5. 系统自动生成 → 费用记录（状态：未支付）
   ↓
6. 管理员 → 标记支付 → 费用状态：已支付
   ✅ 流程结束

【退款流程】
6. 费用状态：已支付
   ↓
7. 居民 → 申请退款 → 费用状态：退款申请中
   ↓
8. 管理员审批：
   - 同意退款 → 费用状态：已退款 ✅
   - 拒绝退款 → 费用状态：已支付 ❌

【取消流程】
- 待确认/已确认状态可以取消
- 已完成状态不可取消（只能退款）
```

### 状态流转图

**预约状态：**
```
待确认 → 已确认 → 已完成
   ↓        ↓
已取消    已取消
```

**费用状态：**
```
未支付 → 已支付 → 退款申请中 → 已退款
                            ↓
                        已支付（拒绝）
```

---

## 🎨 UI/UX 优化

### 主题色方案
- **主色调**：浅青色 `#E4EFF1`（侧边栏、卡片背景）
- **强调色**：原生蓝色（登录按钮）
- **背景色**：白色 `#FFFFFF`
- **文字色**：深灰/黑色

### 布局优化
- ✅ 侧边栏统一配色（#E4EFF1）
- ✅ 顶部导航栏配色一致
- ✅ 卡片圆角设计（12px）
- ✅ 卡片阴影效果
- ✅ 响应式按钮样式
- ✅ 统一分页样式

### 组件优化
- ✅ 表格行高优化（size="small"）
- ✅ 按钮文字链接样式（text 类型）
- ✅ 标签颜色语义化（状态标签）
- ✅ 评分列宽度扩展（170px 显示完整星星）
- ✅ 输入框背景统一为白色

### 页面优化
- ✅ 登录页：白色主题，蓝色登录按钮
- ✅ 注册页：角色简化（仅居民/护工），白色主题
- ✅ 仪表盘：3列卡片布局，移除快捷操作，欢迎卡片白色背景
- ✅ 护工管理：对话框标题改为"新增员工/编辑员工"

---

## 📂 项目结构

### 后端结构
```
oldcare-system/
├── src/main/java/com/example/oldcaresystem/
│   ├── controller/          # 控制器层
│   │   ├── UserController.java
│   │   ├── AppointmentController.java
│   │   ├── FeeRecordController.java
│   │   └── ...
│   ├── entity/              # 实体类
│   │   ├── User.java
│   │   ├── Appointment.java
│   │   ├── FeeRecord.java
│   │   └── ...
│   ├── service/             # 服务层
│   │   ├── UserService.java
│   │   ├── AppointmentService.java
│   │   └── ...
│   ├── mapper/              # MyBatis Mapper
│   ├── security/            # 安全配置
│   │   ├── JwtUtil.java
│   │   ├── SecurityConfig.java
│   │   └── UserContext.java
│   └── util/                # 工具类
│       ├── ApiResponse.java
│       └── ResponseUtil.java
├── src/main/resources/
│   ├── application.properties
│   └── mapper/              # MyBatis XML
└── pom.xml
```

### 前端结构
```
oldcare-system-front/
├── src/
│   ├── api/                 # API 接口封装
│   │   ├── http.js          # Axios 实例
│   │   ├── auth.js
│   │   ├── appointment.js
│   │   ├── feeRecord.js
│   │   └── ...
│   ├── assets/              # 静态资源
│   │   ├── main.css         # 全局样式
│   │   └── base.css
│   ├── components/          # 公共组件
│   ├── router/              # 路由配置
│   │   └── index.js
│   ├── store/               # 状态管理
│   │   └── auth.js          # 认证状态
│   ├── views/               # 页面组件
│   │   ├── LoginView.vue
│   │   ├── RegisterView.vue
│   │   ├── DashboardView.vue
│   │   ├── LayoutShell.vue
│   │   ├── AppointmentView.vue
│   │   ├── FeeRecordView.vue
│   │   ├── CaregiverView.vue
│   │   ├── ElderlyView.vue
│   │   └── ...
│   ├── App.vue
│   └── main.js
├── index.html
├── package.json
└── vite.config.js
```

---

## 🔧 技术亮点

### 1. JWT 认证机制
- 使用 JWT Token 实现无状态认证
- Token 存储在 sessionStorage（支持多标签页独立登录）
- 请求拦截器自动添加 Authorization 头

### 2. 前后端数据兼容
- 费用记录同时支持 `residentId`（新）和 `elderlyId`（旧）
- 居民表通过 `user_id` 关联用户表
- 护工表通过 `user_id` 关联用户表

### 3. 业务状态机
- 预约状态：待确认 → 已确认 → 已完成 → 已取消
- 费用状态：未支付 → 已支付 → 退款申请中 → 已退款
- 严格的状态流转校验

### 4. 自动化流程
- 完成预约自动生成费用记录
- 防止重复生成费用记录
- 关联数据级联更新

### 5. 权限控制
- 后端基于角色的访问控制（RBAC）
- 前端路由守卫
- 接口级别的权限校验

---

## 📊 数据库设计

### 核心表结构

**users（用户表）**
- 存储所有用户账号信息
- 包含角色字段（admin/caregiver/resident）

**elderly_info（居民档案表）**
- 关联 users 表（user_id）
- 存储居民详细信息

**caregivers（护工表）**
- 关联 users 表（user_id）
- 存储护工详细信息

**appointments（预约表）**
- 关联 elderly_info（elderly_id）
- 关联 caregivers（provider_id）
- 关联 services（service_id）

**fee_records（费用记录表）**
- 关联 appointments（appointment_id）
- 关联 users/elderly_info（resident_id/elderly_id）

**evaluations（评价表）**
- 关联 appointments（appointment_id）
- 关联 caregivers（provider_id）

---

## 🐛 已解决的问题

### 1. 多标签页登录冲突
**问题**：多个标签页登录不同账号，刷新页面会变成最后登录的账号  
**解决**：将 localStorage 改为 sessionStorage，每个标签页独立存储

### 2. 注册按钮颜色覆盖
**问题**：Element Plus 默认按钮样式优先级高，无法修改颜色  
**解决**：使用 `:deep()` 选择器 + 全局 CSS 覆盖

### 3. 输入框蓝色背景
**问题**：Element Plus 输入框有默认蓝色背景  
**解决**：使用 `:deep(.el-input__wrapper)` 设置白色背景

### 4. 评分星星显示不全
**问题**：评分列宽度太窄，星星被截断  
**解决**：将评分列宽度从 100px 扩展到 170px

### 5. 退款按钮逻辑错误
**问题**：管理员直接退款按钮调用的接口不支持该逻辑  
**解决**：移除直接退款按钮，使用居民申请+管理员审批的正确流程

---

## 🚀 部署说明

### 后端部署
1. 配置数据库连接（application.properties）
2. 执行数据库初始化脚本
3. 使用 Maven 构建：`mvn clean package`
4. 运行 JAR 包：`java -jar oldcare-system.jar`
5. 默认端口：8080

### 前端部署
1. 安装依赖：`npm install`
2. 开发环境：`npm run dev`
3. 生产构建：`npm run build`
4. 部署 dist 目录到 Nginx/Apache
5. 配置反向代理到后端 API

---

## 📈 未来优化方向

### 功能扩展
- [ ] 移动端适配（响应式设计）
- [ ] 实时消息通知（WebSocket）
- [ ] 数据导出功能（Excel）
- [ ] 高级数据分析和报表
- [ ] 文件上传（头像、附件）
- [ ] 微信小程序端

### 技术优化
- [ ] 接口性能优化（缓存、分页）
- [ ] 前端状态管理优化
- [ ] 单元测试和集成测试
- [ ] CI/CD 自动化部署
- [ ] Docker 容器化部署
- [ ] 日志系统和监控

### 用户体验
- [ ] 国际化支持（i18n）
- [ ] 深色模式
- [ ] 更丰富的图表展示
- [ ] 操作引导和帮助文档
- [ ] 快捷键支持

---

## 📝 开发团队与维护

**项目维护**：活跃开发中  
**最后更新**：2025年12月27日  
**代码托管**：本地仓库

---

## 📄 许可证

本项目仅供学习和研究使用。

---

## 🎓 项目总结

本养老服务管理系统是一个**完整的前后端分离项目**，涵盖了：
- ✅ 完整的用户认证和授权机制
- ✅ 多角色权限管理
- ✅ 复杂业务流程（预约-费用-退款）
- ✅ 现代化的前端 UI 设计
- ✅ 规范的后端接口设计
- ✅ 良好的代码结构和可维护性

该项目展示了从**需求分析**到**编码实现**再到**UI 优化**的完整开发流程，是一个典型的企业级管理系统案例。

---

**感谢使用本系统！**
